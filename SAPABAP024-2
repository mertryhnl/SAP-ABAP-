*&---------------------------------------------------------------------*
*& Report ZBK_P024
*&---------------------------------------------------------------------*
*&OO ALV-> SCREEN & CONTAINER & FULL SCREEN
*&OO ALV-> FIELDCATALOG & LAYOUT
*&OO ALV-> FIELDCATALOG & MERGE
*&---------------------------------------------------------------------*
REPORT zbk_p024.

INCLUDE ZBK_P024_top.
INCLUDE ZBK_P024_pbo.
INCLUDE ZBK_P024_pai.
INCLUDE ZBK_P024_frm.

START-OF-SELECTION.

  PERFORM get_data.
  PERFORM set_fcat.
  PERFORM set_layout.

  CALL SCREEN 0100.














*&---------------------------------------------------------------------*
*& Include          ZBK_P024_TOP
*&---------------------------------------------------------------------*
DATA: go_alv  TYPE REF TO cl_gui_alv_grid,
      go_cont TYPE REF TO cl_gui_custom_container.

DATA: gt_ekko  TYPE TABLE OF ekko,
      gt_fcat   TYPE lvc_t_fcat,
      gs_fcat   TYPE lvc_s_fcat,
      gs_layout TYPE lvc_s_layo.















*&---------------------------------------------------------------------*
*& Include          ZBK_P024_PBO
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0100 OUTPUT.
  SET PF-STATUS '0100'.
  SET TITLEBAR '0100'.

  PERFORM display_alv.

ENDMODULE.



















*&---------------------------------------------------------------------*
*& Include          ZBK_P024_PAI
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0100 INPUT.
  CASE sy-ucomm.
    WHEN '&BACK'.
      SET SCREEN 0.
  ENDCASE.
ENDMODULE.




























*&---------------------------------------------------------------------*
*& Include          ZBK_P024_FRM
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Form display_alv
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM display_alv .
*  CREATE OBJECT go_cont
*    EXPORTING
*      container_name = 'CC_ALV'.
*
*  CREATE OBJECT go_alv
*    EXPORTING
*      i_parent = go_cont.

  CREATE OBJECT go_alv
    EXPORTING
      i_parent = cl_gui_container=>screen0.

  CALL METHOD go_alv->set_table_for_first_display
    EXPORTING
*     i_buffer_active =                  " Buffering Active
*     i_bypassing_buffer            =                  " Switch Off Buffer
*     i_consistency_check           =                  " Starting Consistency Check for Interface Error Recognition
*     i_structure_name =                  " Internal Output Table Structure Name
*     is_variant      =                  " Layout
*     i_save          =                  " Save Layout
*     i_default       = 'X'              " Default Display Variant
      is_layout       = gs_layout         " Layout
*     is_print        =                  " Print Control
*     it_special_groups             =                  " Field Groups
*     it_toolbar_excluding          =                  " Excluded Toolbar Standard Functions
*     it_hyperlink    =                  " Hyperlinks
*     it_alv_graphics =                  " Table of Structure DTC_S_TC
*     it_except_qinfo =                  " Table for Exception Quickinfo
*     ir_salv_adapter =                  " Internal Usage only !!! - obsolete
    CHANGING
      it_outtab       = gt_ekko              " Output Table
      it_fieldcatalog = gt_fcat                 " Field Catalog
*     it_sort         =                  " Sort Criteria
*     it_filter       =                  " Filter Criteria
*    EXCEPTIONS
*     invalid_parameter_combination = 1                " Wrong Parameter
*     program_error   = 2                " Program Errors
*     too_many_lines  = 3                " Too many Rows in Ready for Input Grid
*     others          = 4
    .
  IF sy-subrc <> 0.
*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*     WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form get_data
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM get_data .
  SELECT * FROM ekko
    INTO TABLE gt_ekko.
ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_fcat
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_fcat .
  CLEAR: gs_fcat.

*  gs_fcat-fieldname = 'CARRID'.
*  gs_fcat-scrtext_s = 'A. Code'.
*  gs_fcat-scrtext_m = 'Airline Code'.
*  gs_fcat-scrtext_l = 'Airline Code'.
*  gs_fcat-col_pos   = 1.                  "Kolonun hangi sırada olacağını belirler
*  gs_fcat-col_opt   = abap_true.          "Kolonunu içindeki en uzun karaktere sahip veriye göre genişletir.
*  gs_fcat-key       = abap_true.          "Kolonun 'KEY' olduğunu belirtir, arka planını değiştirir, kaydırma yapsanda sabit kalır.
*  APPEND gs_fcat TO gt_fcat.
*
*  gs_fcat-fieldname = 'CARRNAME'.
*  gs_fcat-scrtext_s = 'A. name'.
*  gs_fcat-scrtext_m = 'Airline name'.
*  gs_fcat-scrtext_l = 'Airline name'.
*  gs_fcat-col_pos   = 2.
*  gs_fcat-col_opt   = abap_true.
*  gs_fcat-edit      = abap_true.          "Kolonu düzenleyebilir hale geliriz. Ancak tabloya yansıması için yeterli bir kod değildir.
*  APPEND gs_fcat TO gt_fcat.
*
*  gs_fcat-fieldname = 'CURRCODE'.
*  gs_fcat-scrtext_s = 'LOCAL CURR'.
*  gs_fcat-scrtext_m = 'Local currency of A.'.
*  gs_fcat-scrtext_l = 'Local currency of airline'.
*  gs_fcat-col_pos   = 3.
*  gs_fcat-col_opt   = abap_true.
*  gs_fcat-hotspot   = abap_true.          "Kolonu tıklanabilir hale getirir.
*  APPEND gs_fcat TO gt_fcat.
*
*  gs_fcat-fieldname = 'URL'.
*  gs_fcat-scrtext_s = 'A. URL'.
*  gs_fcat-scrtext_m = 'Airline URL'.
*  gs_fcat-scrtext_l = 'Airline URL'.
*  gs_fcat-col_pos   = 4.
*  gs_fcat-col_opt   = abap_true.
*  gs_fcat-no_out    = abap_true.          "Kolonu fieldcatolog yazsam bile gizler.
*  APPEND gs_fcat TO gt_fcat.

  CALL FUNCTION 'LVC_FIELDCATALOG_MERGE'
    EXPORTING
*     I_BUFFER_ACTIVE  =
      i_structure_name = 'EKKO'
*     I_CLIENT_NEVER_DISPLAY       = 'X'
*     I_BYPASSING_BUFFER           =
*     I_INTERNAL_TABNAME           =
    CHANGING
      ct_fieldcat      = gt_fcat
* EXCEPTIONS
*     INCONSISTENT_INTERFACE       = 1
*     PROGRAM_ERROR    = 2
*     OTHERS           = 3
    .
  IF sy-subrc <> 0.
* Implement suitable error handling here
  ENDIF.


ENDFORM.
*&---------------------------------------------------------------------*
*& Form set_layout
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM set_layout .
  CLEAR: gs_layout.

  "LAYOUT için yazdığımız tüm kodlar tüm alv'yi etkiler.
  gs_layout-cwidth_opt = abap_true.  "Tüm kolanları optimize eder.
*gs_layout-edit       = abap_true.  "Tüm kolonları yazılabilir hale getirir.
*gs_layout-no_toolbar = abap_true.  "Toolbar'ı kapatır.
  gs_layout-zebra      = abap_true.  "Görsel değişiklik yapar.
ENDFORM.
